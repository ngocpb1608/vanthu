{% extends "base.html" %}
{% block content %}
<div class="card">
  <h3 style="margin-top:0">{{ 'Thêm công văn' if mode=='new' else 'Sửa công văn' }}</h3>
  <form method="post" style="display:grid;gap:10px;grid-template-columns:repeat(2,minmax(0,1fr))">
    <input class="ipt" name="ma" placeholder="Mã (tùy chọn)" value="{{ r.ma if r else '' }}">
    <input class="ipt" name="loai_don_thu" placeholder="Loại đơn thư" value="{{ r.loai_don_thu if r else '' }}">
    <input class="ipt" name="thang" placeholder="Tháng" value="{{ default_thang }}">
    <input class="ipt" name="nam" placeholder="Năm" value="{{ default_nam }}">
    <input class="ipt" name="ma_kh" placeholder="Mã KH" value="{{ r.ma_kh if r else '' }}">
    <input class="ipt" name="ten" placeholder="Tên KH" value="{{ r.ten if r else '' }}">
    <input class="ipt" name="dia_chi" placeholder="Địa chỉ" value="{{ r.dia_chi if r else '' }}">
    <input class="ipt" name="nhan_vien" placeholder="Nhân viên" value="{{ r.nhan_vien if r else '' }}">
    <textarea class="ipt" name="noi_dung" placeholder="Nội dung" style="grid-column:span 2;height:120px">{{ r.noi_dung if r else '' }}</textarea>
    <input class="ipt" type="date" name="ngay_nv_nhan" value="{{ r.ngay_nv_nhan if r and r.ngay_nv_nhan else '' }}">
    <select class="ipt" name="tinh_trang">
      {% set val = r.tinh_trang if r else '' %}
      <option value="">Tình trạng</option>
      <option value="NV chưa lấy đơn" {% if val=='NV chưa lấy đơn' %}selected{% endif %}>NV chưa lấy đơn</option>
      <option value="Đang giải quyết" {% if val=='Đang giải quyết' %}selected{% endif %}>Đang giải quyết</option>
      <option value="Hoàn Thành" {% if val=='Hoàn Thành' %}selected{% endif %}>Hoàn Thành</option>
    </select>

    <div style="grid-column:span 2;display:flex;gap:8px">
      <button class="btn brand" type="submit">{{ 'Lưu' if mode=='edit' else 'Thêm' }}</button>
      <a class="btn" href="{{ url_for('dashboard') }}">Hủy</a>
    </div>
  </form>
</div>
{% endblock %}
